!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserService=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4);t.UserService=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user={}}return r(e,[{key:"hasUser",value:function(){var e=JSON.parse(localStorage.getItem("storiesUser"));return!!e&&(this.user=new o.User,this.user.setUserName(e.userName),this.user.group=e.group,!0)}},{key:"removeUser",value:function(){localStorage.removeItem("storiesUser"),this.user={}}},{key:"getUser",value:function(){var e=JSON.parse(localStorage.getItem("storiesUser")),t=new o.User;return t.setUserName(e.userName),t.group=e.group,console.log("UserService::getUser"),t}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Menu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=[{title:"Accueil",active:"always",path:"/"},{title:"Toutes les Stories",active:"isAdmin",path:"/allstories"},{title:"Mes stories",active:"always",path:"/mystories"},{title:"Mon compte",active:"always",options:[{title:"Mes préférences",path:"/settings"},{title:"Changer de mot de passe",path:"/changepassword"},{divider:!0},{title:"Déconnexion",path:"/logout"}]}]}return r(e,[{key:"setUser",value:function(e){this.user=e,this._update(),this._activate()}},{key:"_update",value:function(){$("#userMenu").html(this.user.userName);var e=$("#userMenuOptions");e.empty();var t=this.options[3].options,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;this._makeOption(u).appendTo(e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}e.removeClass("hidden")}},{key:"clear",value:function(){var e=$("#userMenuOptions");e.empty(),e.addClass("hidden"),$("#userMenu").html("Utilisateur")}},{key:"_makeOption",value:function(e){var t=null;return e.hasOwnProperty("title")?(t=$("<a>")).addClass("dropdown-item").attr("href","#"+e.path).html(e.title):(t=$("<div>")).addClass("dropdown-divider"),t}},{key:"_activate",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.options[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value,a=$('[title="'+i.title+'"]');"always"===i.active?a.removeClass("disabled"):"isAdmin"===i.active&&"Administrateur"===this.user.group&&a.removeClass("disabled")}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Route=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.path=t,this.controller=n,this.canActivate=r}return r(e,[{key:"getPath",value:function(){return this.path}},{key:"getController",value:function(){return this.controller}},{key:"getCanActivate",value:function(){return this.canActivate}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginController=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7);t.LoginController=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view="./src/user/login/views/loginform.view.html",this.login=new o.Login}return r(e,[{key:"getView",value:function(){var e=$("[app]");$.get(this.view,function(t){e.empty(),e.html(t)})}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.User=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"setUserName",value:function(e){this.userName=e}},{key:"setPassword",value:function(e){this.password=e}},{key:"authenticate",value:function(){if("jlaubert"===this.userName&&"jla"===this.password){this.group="Administrateur";var e={userName:this.userName,group:this.group};return localStorage.setItem("storiesUser",JSON.stringify(e)),!0}return!1}}]),e}()},function(e,t,n){"use strict";var r=n(6),o=n(2),i=n(0),a=new r.Router,u=new i.UserService;a.add(new o.Route("/","LoginController",u)).add(new o.Route("/mystories","MyStories",u)).add(new o.Route("/logout","LogoutController")).add(new o.Route("/errors","Error"))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(n(2),n(3)),i=n(9),a=n(10),u=n(11),s=n(0);var l={LoginController:o.LoginController,LogoutController:a.LogoutController,MyStories:i.MyStories,Error:u.Error};t.Router=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.routes=new Map;var t=this;$(window).on("hashchange",function(e){t.getRoute()}),$(window).on("load",function(e){t.getRoute()})}return r(e,[{key:"add",value:function(e){return this.routes.set(e.path,e),this}},{key:"getRoute",value:function(){var e=location.hash.slice(1)||"/";console.log("URL à charger ["+e+"]");var t=this.routes.get(e),n={};if(t)if("/"===e){n=(new s.UserService).hasUser()?new i.MyStories:new o.LoginController}else{console.log("Instancie : "+t.getController());var r=t.getCanActivate();n=r?r.hasUser()?new(l[t.getController()]):new o.LoginController:new(l[t.getController()])}else n=new u.Error;n.getView()}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Login=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),i=n(1),a=n(8);t.Login=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$(document).attr("title","Identification"),$("#main-title").html("Page d'authentification"),this.formListener(),this.submitListener()}return r(e,[{key:"formListener",value:function(){$("[app]").on("keyup","#loginForm",function(e){var t=$('[name="loginField"]'),n=$('[name="passwordField"]');t.val().length>=5&&""!==n.val()?$("#btnLogin").removeAttr("disabled","disabled"):$("#btnLogin").attr("disabled","disabled")})}},{key:"submitListener",value:function(){$("[app]").on("submit","#loginForm",function(e){var t=$('[name="loginField"]'),n=$('[name="passwordField"]');e.preventDefault();var r=new o.User;(r.setUserName(t.val()),r.setPassword(n.val()),r.authenticate())?(console.log("Authentification réussie"),(new i.Menu).setUser(r),document.location.replace("#/mystories")):(console.log("Authentification impossible"),t.val(""),n.val(""),$("#btnLogin").attr("disabled","disabled"),new a.Toast({message:"Ce login ou ce mot de passe ne correspond à aucun utilisateur",duration:5}).toastIt())})}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Toast=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.hasOwnProperty("background")?this.backgroundClass=t.background:this.backgroundClass="danger",t.hasOwnProperty("duration")?this.duration=t.duration:this.duration=3,t.hasOwnProperty("message")?this.message=t.message:this.message="default message"}return r(e,[{key:"setBackground",value:function(e){this.backgroundClass=e}},{key:"setDuration",value:function(e){this.duration=e}},{key:"toastIt",value:function(){var e=$("<div>");e.addClass("toast").addClass(this.backgroundClass).addClass("animated").addClass("fadeInDownBig").html(this.message.bold()),e.appendTo($("body")),setTimeout(function(){setTimeout(1e3*(this.duration,void e.addClass("fadeOutRightBig"))),e.remove()},1e3*this.duration)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MyStories=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),i=n(0);t.MyStories=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view="./src/stories/views/stories.view.html";var t=new i.UserService;(new o.Menu).setUser(t.getUser())}return r(e,[{key:"getView",value:function(){var e=$("[app]");$.get(this.view,function(t){e.empty(),e.html(t)})}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogoutController=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(3),i=n(0),a=n(1);t.LogoutController=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(new i.UserService).removeUser(),(new a.Menu).clear(),this.login=new o.LoginController}return r(e,[{key:"getView",value:function(){return this.login.getView()}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Error=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view="./src/errors/views/error.view.html"}return r(e,[{key:"getView",value:function(){var e=$("[app]");$.get(this.view,function(t){e.empty(),e.html(t)})}}]),e}()}]);
//# sourceMappingURL=main.bundle.js.map